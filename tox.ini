[tox]
envlist = py{37,38},lint,security,docs
skipsdist = True

[testenv]
usedevelop = True
deps =
    -rtest-requirements.txt
commands =
    pytest -v {posargs}


[testenv:lint]
commands =
    black --check {posargs:.}
    isort --check {posargs:.}
    flake8 {posargs}


[testenv:security]
commands =
    bandit -r -ll -x ./.tox,./tests .


[testenv:docs]
deps =
    sphinx
changedir = datagrepper/docs
allowlist_externals =
    mkdir
    rm
commands=
    mkdir -p _static
    rm -rf _build
    rm -rf _source
    sphinx-build -b html -d {envtmpdir}/doctrees .  _build/html


[flake8]
show-source = True
max-line-length = 100
exclude = .git,.tox,dist,*egg
